<!-- EREDIVISIE DATABASE WIDGET - WITH VIDEO COUNTS -->
<div id="esn-ned-container">
    
    <!-- 1. HEADER -->
    <div class="esn-ned-header">
        <div>
            <h2 style="color: #FF8800; margin: 0; text-transform: uppercase; letter-spacing: 1px;">Eredivisie</h2>
            <span style="color: #666; font-size: 14px;">Netherlands â€¢ 2025/2026 Season</span>
        </div>
        <div class="esn-stats-summary">
            <div class="esn-stat-pill">
                <i class="fas fa-video"></i>
                <span id="total-videos-count">0</span> Videos
            </div>
            <div class="esn-stat-pill">
                <i class="fas fa-futbol"></i>
                <span id="teams-with-videos-count">0</span>/18 Teams
            </div>
        </div>
    </div>

    <!-- 2. MAIN LAYOUT -->
    <div class="esn-ned-body">
        
        <!-- SIDEBAR (Team List with Video Counts) -->
        <div class="esn-ned-sidebar">
            <input type="text" id="esn-team-search" placeholder="ðŸ” Search Team..." onkeyup="window.filterTeams()">
            
            <!-- Quick Filters -->
            <div class="esn-filter-bar">
                <button class="esn-filter-btn active" onclick="window.filterByVideoCount('all')">All Teams</button>
                <button class="esn-filter-btn" onclick="window.filterByVideoCount('withVideos')">With Videos</button>
                <button class="esn-filter-btn" onclick="window.filterByVideoCount('noVideos')">No Videos</button>
            </div>
            
            <div id="esn-team-list">
                <!-- Teams load here -->
            </div>
        </div>

        <!-- CONTENT (Video Area) -->
        <div class="esn-ned-content">
            <h1 id="esn-selected-title">Select a Team</h1>
            
            <div class="esn-tabs">
                <button class="esn-tab-btn active" onclick="window.switchTab('fullMatches')">
                    <i class="fas fa-film"></i> Full Matches <span class="tab-count" id="full-count">0</span>
                </button>
                <button class="esn-tab-btn" onclick="window.switchTab('highlights')">
                    <i class="fas fa-star"></i> Highlights <span class="tab-count" id="highlights-count">0</span>
                </button>
                <button class="esn-tab-btn" onclick="window.switchTab('academy')">
                    <i class="fas fa-users"></i> Reserves/U21 <span class="tab-count" id="academy-count">0</span>
                </button>
            </div>

            <div id="esn-video-grid">
                <p style="color: #555; margin-top: 20px;">Select a team from the left to view matches.</p>
            </div>
        </div>

    </div>

    <!-- 3. POPUP VIDEO PLAYER (FULL WINDOW MODE) -->
    <div id="esn-player-modal" class="esn-modal">
        <div class="esn-modal-content">
            <div class="esn-modal-header">
                <span id="esn-playing-title" style="color:#FF8800; font-weight:bold; font-size: 18px;">Match Title</span>
                <span class="esn-close-btn" onclick="window.closeVideo()">âœ• Close</span>
            </div>
            <div class="esn-video-wrapper">
                <iframe id="esn-main-iframe" src="" frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                    allowfullscreen>
                </iframe>
            </div>
        </div>
    </div>

</div>

<!-- CSS STYLES (Enhanced with Video Count Badges) -->
<style>
    /* Font Awesome for icons */
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css');

    /* GLOBAL CONTAINER */
    #esn-ned-container {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        background: #000;
        color: #fff;
        width: 100%;
        min-height: 700px;
        border: 1px solid #333;
        display: flex;
        flex-direction: column;
        position: relative;
        box-sizing: border-box;
    }

    /* HEADER & STATS */
    .esn-ned-header { 
        padding: 25px; 
        border-bottom: 2px solid #FF8800; 
        background: #111; 
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
    }
    
    .esn-stats-summary {
        display: flex;
        gap: 15px;
    }
    
    .esn-stat-pill {
        background: #1a1a1a;
        padding: 8px 16px;
        border-radius: 20px;
        border: 1px solid #333;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: #FF8800;
    }
    
    .esn-stat-pill i {
        font-size: 14px;
    }
    
    .esn-stat-pill span {
        font-weight: bold;
    }

    .esn-ned-body { display: flex; flex: 1; height: 650px; }
    
    /* SIDEBAR */
    .esn-ned-sidebar { 
        width: 28%; 
        min-width: 250px; 
        background: #111; 
        border-right: 1px solid #333; 
        display: flex; 
        flex-direction: column; 
    }
    
    #esn-team-search { 
        background: #000; 
        border: none; 
        border-bottom: 1px solid #333; 
        color: white; 
        padding: 15px; 
        width: 100%; 
        box-sizing: border-box; 
        font-size: 14px; 
    }
    
    #esn-team-search:focus { outline: 1px solid #FF8800; }
    
    /* FILTER BAR */
    .esn-filter-bar {
        display: flex;
        gap: 5px;
        padding: 10px;
        background: #0a0a0a;
        border-bottom: 1px solid #222;
    }
    
    .esn-filter-btn {
        flex: 1;
        background: #1a1a1a;
        border: 1px solid #333;
        color: #888;
        padding: 8px 10px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        cursor: pointer;
        border-radius: 4px;
        transition: all 0.2s;
    }
    
    .esn-filter-btn:hover {
        background: #222;
        color: #fff;
    }
    
    .esn-filter-btn.active {
        background: #FF8800;
        color: #000;
        border-color: #FF8800;
    }
    
    #esn-team-list { 
        overflow-y: auto; 
        flex: 1; 
    }
    
    /* TEAM ITEMS WITH VIDEO COUNTS */
    .esn-team-item { 
        padding: 15px 20px; 
        border-bottom: 1px solid #222; 
        cursor: pointer; 
        display: flex; 
        justify-content: space-between; 
        align-items: center;
        font-size: 14px; 
        color: #ccc; 
        transition: 0.2s; 
    }
    
    .esn-team-item:hover { 
        background: #1a1a1a; 
        color: #fff; 
    }
    
    .esn-team-item.active { 
        background: #1a1a1a; 
        border-left: 4px solid #FF8800; 
        color: #FF8800; 
        font-weight: bold; 
    }
    
    .esn-team-name {
        flex: 1;
    }
    
    .esn-video-badge {
        background: #1a1a1a;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: bold;
        color: #666;
        border: 1px solid #333;
        min-width: 35px;
        text-align: center;
    }
    
    .esn-team-item:hover .esn-video-badge {
        border-color: #FF8800;
        color: #FF8800;
    }
    
    .esn-team-item.active .esn-video-badge {
        background: #FF8800;
        color: #000;
        border-color: #FF8800;
    }
    
    .esn-video-badge.has-videos {
        color: #FF8800;
        border-color: #FF8800;
    }
    
    .esn-video-badge.no-videos {
        color: #444;
        border-color: #222;
    }

    /* CONTENT AREA */
    .esn-ned-content { 
        width: 72%; 
        padding: 30px; 
        background: #080808; 
        overflow-y: auto; 
    }
    
    #esn-selected-title { 
        margin-top: 0; 
        text-transform: uppercase; 
        color: #fff; 
        font-size: 28px; 
    }

    /* TABS WITH COUNTS */
    .esn-tabs { 
        display: flex; 
        gap: 20px; 
        margin-bottom: 25px; 
        border-bottom: 1px solid #333; 
    }
    
    .esn-tab-btn { 
        background: none; 
        border: none; 
        color: #666; 
        padding: 12px 15px; 
        cursor: pointer; 
        font-weight: bold; 
        font-size: 14px; 
        border-bottom: 3px solid transparent; 
        transition: 0.3s; 
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .esn-tab-btn:hover { 
        color: #fff; 
    }
    
    .esn-tab-btn.active { 
        color: #FF8800; 
        border-bottom: 3px solid #FF8800; 
    }
    
    .tab-count {
        background: #1a1a1a;
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 11px;
        font-weight: bold;
        border: 1px solid #333;
    }
    
    .esn-tab-btn.active .tab-count {
        background: #FF8800;
        color: #000;
        border-color: #FF8800;
    }

    /* VIDEO CARDS */
    .esn-v-card { 
        background: #151515; 
        border: 1px solid #333; 
        border-radius: 6px; 
        margin-bottom: 12px; 
        padding: 18px; 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        cursor: pointer; 
        transition: all 0.2s ease; 
    }
    
    .esn-v-card:hover { 
        border-color: #FF8800; 
        transform: translateX(8px); 
        background: #1a1a1a; 
    }
    
    .esn-v-info h4 { 
        margin: 0 0 6px 0; 
        color: #fff; 
        font-size: 16px; 
    }
    
    .esn-v-info span { 
        color: #777; 
        font-size: 13px; 
    }
    
    .esn-v-play { 
        color: #FF8800; 
        font-size: 24px; 
    }

    /* FULL SCREEN MODAL STYLES */
    .esn-modal {
        display: none; 
        position: fixed; 
        z-index: 2147483647; 
        left: 0; top: 0; 
        width: 100vw; height: 100vh; 
        background-color: #000; 
    }

    .esn-modal-content {
        width: 100%;
        height: 100%;
        margin: 0;
        background: #000;
        display: flex;
        flex-direction: column;
        border: none;
    }

    .esn-modal-header {
        flex-shrink: 0; 
        padding: 15px 25px;
        background: #111;
        border-bottom: 1px solid #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .esn-close-btn { 
        cursor: pointer; 
        color: #fff; 
        font-size: 18px; 
        padding: 5px 15px; 
        background: #333;
        border-radius: 4px;
        transition: 0.2s;
    }
    
    .esn-close-btn:hover { 
        background: #FF8800; 
        color: #000; 
    }
    
    .esn-video-wrapper {
        flex-grow: 1; 
        width: 100%;
        position: relative;
        background: #000;
    }

    .esn-video-wrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
    }

    /* RESPONSIVE */
    @media (max-width: 900px) {
        .esn-ned-body { flex-direction: column; height: auto; }
        .esn-ned-sidebar { width: 100%; max-height: 300px; }
        .esn-ned-content { width: 100%; }
    }
</style>

<!-- JAVASCRIPT LOGIC (Enhanced with Video Counting) -->
<script>
(function() {

    // ==========================================
    // 1. DATABASE - ADD YOUR MATCHES HERE
    // ==========================================
    const db = {
        "ajax": {
            fullMatches: [
                { title: "vs Telstar", date: "10 August 2025", link: "https://player.mux.com/HlRUZKJsqYlEHBe6ThLIMMTn98V01CXbXAb5qDoQzXl00" },
                { title: "vs PSV Eindhoven", date: "2 November 2025", link: "https://player.mux.com/CpQwnibKZEWfQWkFdaml27nUoMxwbLIHDOPXp01QRjKA" },
            ],
            highlights: [
                { title: "Season Goals 2024/25", date: "Highlights", link: "https://player.mux.com/1HFe2t6PWeEpjjukQUQvqFHKXCn5iKPgFJtDrt8hGT8" },
            ],
            academy: [
		{ title: "vs FC Den Bosch", date: "8 August 2025", link: "https://player.mux.com/gG1OBPE02Kvr02QoclqChdfuzQjZvsoMY6wfSGsFvoywY" },
		{ title: "vs Jong AZ (AZ Alkmaar U21)", date: "18 August 2025", link: "https://player.mux.com/mbIptDal00bMx5En402d2LqNdNXvL4CIxIUGUrc6yL2GI" },
	    ],
        },
        "psv eindhoven": {
            fullMatches: [
                { title: "vs Sparta Rotterdam", date: "9 August 2025", link: "https://player.mux.com/5OurPijDA8c600xk7tDQlcfHuCTiaui8onAzd2Zb00xfQ" },
                { title: "vs AZ Alkmaar", date: "19 October 2025", link: "https://player.mux.com/joySVKHfLihFy02PTL56mw351wVAZag2XXo3F46OWD4s" },
            ],
            highlights: [],
            academy: [
		{ title: "vs FC Emmen", date: "11 August 2025", link: "https://player.mux.com/lRUYZreDGERpRB00KreA6lRMfQ5GD5C01SUcDgo2oB502o" },
]
        },
        "feyenoord": {
            fullMatches: [
                { title: "vs Ajax", date: "27 October 2025", link: "https://player.mux.com/fW2JRswHiQqY7uzRxC4WBr00dhk2xG29aITS02W3AlS600" },
		{ title: "vs NAC Breda", date: "9 August 2025", link: "https://player.mux.com/gP00Lf00piDHEo1WfIQvRJyD7ymFzJnfjFVWaBpy5R8JQ" },
            ],
            highlights: [],
            academy: []
        },
        "az alkmaar": {
            fullMatches: [
                { title: "vs FC Volendam", date: "17 August 2025", link: "https://player.mux.com/b9oyXjGYa9iKanJZGVkfQYZnhqioA3J2ZTiaF9r19n8" },
		{ title: "vs Go Ahead Eagles", date: "7 December 2025", link: "https://player.mux.com/01HNlILIRB00mWd17e2N02tALiYtL4ZloYYOBm5qSnXWBI" },
            ],
            highlights: [],
            academy: [
		{ title: "vs Jong Ajax (Ajax U21)", date: "18 August 2025", link: "https://player.mux.com/mbIptDal00bMx5En402d2LqNdNXvL4CIxIUGUrc6yL2GI" }
]
        },
        "fc twente": {
            fullMatches: [
		{ title: "vs PEC Zwolle", date: "10 August 2025", link: "https://player.mux.com/cl5b2pNMD7XoB3gR2jnZMPCqJIcdRzM6t7dUlC7ToAI" },
],
            highlights: [],
            academy: []
        },
        "fc utrecht": {
            fullMatches: [
		{ title: "vs FC Volendam", date: "18 October 2025", link: "https://player.mux.com/EVx88W7V9afEiRtmKVJXNzweiR9s3xfxs01rFa00gTpdc" },
],
            highlights: [],
            academy: [
		{ title: "vs ADO Den Haag", date: "18 August 2025", link: "https://player.mux.com/lRUYZreDGERpRB00KreA6lRMfQ5GD5C01SUcDgo2oB502o" },

]
        },
        "sparta rotterdam": {
            fullMatches: [
		{ title: "vs Go Ahead Eagles", date: "23 August 2025", link: "https://player.mux.com/kIUcLd8HQpSbJpzMCe43I7MJI02VWo77q02g3o5ne00ukA" },
		{ title: "vs PSV", date: "9 August 2025", link: "https://player.mux.com/5OurPijDA8c600xk7tDQlcfHuCTiaui8onAzd2Zb00xfQ" },
],
            highlights: [],
            academy: []
        },
        "nec nijmegen": {
            fullMatches: [
		{ title: "vs NAC Breda", date: "24 August 2025", link: "https://player.mux.com/MXkIq4AsPpMVt00FGnKDBOfzpU02kd7wWTjMQ38YrCfi4" },
		{ title: "vs SBV Excelsior", date: "9 August 2025", link: "https://player.mux.com/xDFFChLlZwqCwG9HuJOXCcdJiTUMiuERPnrcpDCoM5U" },
],
            highlights: [],
            academy: []
        },
        "sc heerenveen": {
            fullMatches: [
		{ title: "vs FC Volendam", date: "9 August 2025", link: "https://player.mux.com/jchWnPDs6cuaCKHFH3VWGwC02hETuv01XQBqsmQb6H6Ss" },
],
            highlights: [],
            academy: []
        },
        "nac breda": {
            fullMatches: [
		{ title: "vs NEC Nijmegen", date: "24 August 2025", link: "https://player.mux.com/MXkIq4AsPpMVt00FGnKDBOfzpU02kd7wWTjMQ38YrCfi4" },
		{ title: "vs Fortuna Sittard", date: "17 August 2025 (First Half Only)", link: "https://player.mux.com/mopbbFoVAhZbirKToCjFEx6mPnArExD2W1vCmSQKrE8" },
		{ title: "vs Feyenoord Rotterdam", date: "9 August 2025", link: "https://player.mux.com/gP00Lf00piDHEo1WfIQvRJyD7ymFzJnfjFVWaBpy5R8JQ" },
],
            highlights: [],
            academy: []
        },
        "pec zwolle": {
            fullMatches: [
		{ title: "vs FC Twente", date: "10 August 2025", link: "https://player.mux.com/cl5b2pNMD7XoB3gR2jnZMPCqJIcdRzM6t7dUlC7ToAI" },
],
            highlights: [],
            academy: []
        },
        "fortuna sittard": {
            fullMatches: [
		{ title: "vs NAC Breda", date: "17 August 2025 (First Half Only)", link: "https://player.mux.com/mopbbFoVAhZbirKToCjFEx6mPnArExD2W1vCmSQKrE8" },
		{ title: "vs Go Ahead Eagles", date: "8 August 2025", link: "https://player.mux.com/UAO01OCAnFgLgu35cOkG7wgysosmRnGEcfzZAXVVfI01g" },
],
            highlights: [],
            academy: []
        },
        "heracles almelo": {
            fullMatches: [],
            highlights: [],
            academy: []
        },
        "almere city": {
            fullMatches: [],
            highlights: [],
            academy: []
        },
        "go ahead eagles": {
            fullMatches: [
		{ title: "vs AZ Alkmaar", date: "7 December 2025", link: "https://player.mux.com/01HNlILIRB00mWd17e2N02tALiYtL4ZloYYOBm5qSnXWBI" },
		{ title: "vs Sparta Rotterdam", date: "23 August 2025", link: "https://player.mux.com/kIUcLd8HQpSbJpzMCe43I7MJI02VWo77q02g3o5ne00ukA" },
		{ title: "vs Fortuna Sittard", date: "8 August 2025", link: "https://player.mux.com/UAO01OCAnFgLgu35cOkG7wgysosmRnGEcfzZAXVVfI01g" },
],
            highlights: [],
            academy: []
        },
        "rkc waalwijk": {
            fullMatches: [],
            highlights: [],
            academy: []
        },
        "willem ii": {
            fullMatches: [],
            highlights: [],
            academy: []
        },
        "fc groningen": {
            fullMatches: [],
            highlights: [],
            academy: []
        },
	"fc volendam": {
            fullMatches: [
		{ title: "vs AZ Alkmaar", date: "17 August 2025", link: "https://player.mux.com/b9oyXjGYa9iKanJZGVkfQYZnhqioA3J2ZTiaF9r19n8" },
		{ title: "vs SC Heerenveen", date: "9 August 2025", link: "https://player.mux.com/jchWnPDs6cuaCKHFH3VWGwC02hETuv01XQBqsmQb6H6Ss" },
],
            highlights: [],
            academy: []
	},
	"excelsior rotterdam": {
            fullMatches: [
		{ title: "vs NEC Nijmegen", date: "9 August 2025", link: "https://player.mux.com/xDFFChLlZwqCwG9HuJOXCcdJiTUMiuERPnrcpDCoM5U" },
],
            highlights: [],
            academy: []
	}, 

    };
    
    const allTeams = [
        "Ajax", "Almere City", "AZ Alkmaar", "Feyenoord", "Fortuna Sittard", 
        "Go Ahead Eagles", "FC Groningen", "sc Heerenveen", "Heracles Almelo", 
        "NAC Breda", "NEC Nijmegen", "PEC Zwolle", "PSV Eindhoven", 
        "RKC Waalwijk", "Sparta Rotterdam", "FC Twente", "FC Utrecht", "FC Volendam", "Willem II", "Excelsior Rotterdam"
    ].sort();

    // ==========================================
    // 2. VIDEO COUNT CALCULATION
    // ==========================================
    
    function getVideoCount(teamKey) {
        if (!db[teamKey]) return 0;
        return (db[teamKey].fullMatches?.length || 0) + 
               (db[teamKey].highlights?.length || 0) + 
               (db[teamKey].academy?.length || 0);
    }
    
    function updateGlobalStats() {
        let totalVideos = 0;
        let teamsWithVideos = 0;
        
        Object.keys(db).forEach(key => {
            const count = getVideoCount(key);
            totalVideos += count;
            if (count > 0) teamsWithVideos++;
        });
        
        document.getElementById('total-videos-count').textContent = totalVideos;
        document.getElementById('teams-with-videos-count').textContent = teamsWithVideos;
    }

    // ==========================================
    // 3. TEAM LIST RENDERING WITH COUNTS
    // ==========================================

    let currentTeamKey = null;
    let currentTab = 'fullMatches';
    let currentFilter = 'all';

    setTimeout(function() {
        const list = document.getElementById('esn-team-list');
        if(!list) return;
        
        list.innerHTML = "";
        allTeams.forEach(t => {
            const key = t.toLowerCase();
            const videoCount = getVideoCount(key);
            
            let div = document.createElement('div');
            div.className = 'esn-team-item';
            div.setAttribute('data-video-count', videoCount);
            div.innerHTML = `
                <span class="esn-team-name">${t}</span>
                <span class="esn-video-badge ${videoCount > 0 ? 'has-videos' : 'no-videos'}">${videoCount}</span>
            `;
            div.onclick = function() { window.selectTeam(t, this); };
            list.appendChild(div);
        });
        
        updateGlobalStats();
    }, 500);

    window.selectTeam = function(name, el) {
        currentTeamKey = name.toLowerCase();
        document.getElementById('esn-selected-title').innerText = name;
        
        let items = document.querySelectorAll('.esn-team-item');
        items.forEach(i => i.classList.remove('active'));
        if(el) el.classList.add('active');
        
        // Update tab counts
        const teamData = db[currentTeamKey] || { fullMatches: [], highlights: [], academy: [] };
        document.getElementById('full-count').textContent = teamData.fullMatches?.length || 0;
        document.getElementById('highlights-count').textContent = teamData.highlights?.length || 0;
        document.getElementById('academy-count').textContent = teamData.academy?.length || 0;
        
        window.switchTab('fullMatches');
    };

    // ==========================================
    // 4. FILTER FUNCTIONS
    // ==========================================
    
    window.filterByVideoCount = function(type) {
        currentFilter = type;
        
        // Update button states
        document.querySelectorAll('.esn-filter-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        
        // Filter teams
        const items = document.querySelectorAll('.esn-team-item');
        items.forEach(item => {
            const count = parseInt(item.getAttribute('data-video-count'));
            
            if (type === 'all') {
                item.style.display = 'flex';
            } else if (type === 'withVideos') {
                item.style.display = count > 0 ? 'flex' : 'none';
            } else if (type === 'noVideos') {
                item.style.display = count === 0 ? 'flex' : 'none';
            }
        });
    };

    window.filterTeams = function() {
        let term = document.getElementById('esn-team-search').value.toLowerCase();
        let items = document.querySelectorAll('.esn-team-item');
        
        items.forEach(item => {
            const teamName = item.querySelector('.esn-team-name').innerText.toLowerCase();
            const matchesSearch = teamName.includes(term);
            const count = parseInt(item.getAttribute('data-video-count'));
            
            let shouldShow = matchesSearch;
            
            // Apply current filter
            if (currentFilter === 'withVideos' && count === 0) shouldShow = false;
            if (currentFilter === 'noVideos' && count > 0) shouldShow = false;
            
            item.style.display = shouldShow ? 'flex' : 'none';
        });
    };

    // ==========================================
    // 5. TAB SWITCHING & VIDEO RENDERING
    // ==========================================

    window.switchTab = function(category) {
        currentTab = category;
        let tabs = document.querySelectorAll('.esn-tab-btn');
        tabs.forEach(t => t.classList.remove('active'));
        
        if(category === 'fullMatches') tabs[0].classList.add('active');
        if(category === 'highlights') tabs[1].classList.add('active');
        if(category === 'academy') tabs[2].classList.add('active');

        renderVideos();
    };

    function renderVideos() {
        const grid = document.getElementById('esn-video-grid');
        grid.innerHTML = "";

        if (!currentTeamKey || !db[currentTeamKey] || !db[currentTeamKey][currentTab] || db[currentTeamKey][currentTab].length === 0) {
            grid.innerHTML = '<p style="color:#444; text-align:center; padding:40px 0;">No videos available yet for this category.</p>';
            return;
        }

        db[currentTeamKey][currentTab].forEach(vid => {
            let card = document.createElement('div');
            card.className = 'esn-v-card';
            card.onclick = function() { window.playVideo(vid.link, vid.title); };
            card.innerHTML = `
                <div class="esn-v-info">
                    <h4>${vid.title}</h4>
                    <span>${vid.date}</span>
                </div>
                <div class="esn-v-play">â–¶</div>
            `;
            grid.appendChild(card);
        });
    }

    // ==========================================
    // 6. VIDEO PLAYER LOGIC (FULL SCREEN)
    // ==========================================
    
    window.playVideo = function(url, title) {
        const modal = document.getElementById('esn-player-modal');
        const iframe = document.getElementById('esn-main-iframe');
        const titleSpan = document.getElementById('esn-playing-title');

        titleSpan.innerText = title;

        // Auto-Convert YouTube links
        if (url.includes("youtube.com/watch?v=")) {
            url = url.replace("watch?v=", "embed/");
            if (url.includes("&")) url = url.split("&")[0]; 
        } else if (url.includes("youtu.be/")) {
             url = url.replace("youtu.be/", "youtube.com/embed/");
        }

        iframe.src = url;
        modal.style.display = "block";
    };

    window.closeVideo = function() {
        const modal = document.getElementById('esn-player-modal');
        const iframe = document.getElementById('esn-main-iframe');
        modal.style.display = "none";
        iframe.src = "";
    };

})();
</script>
